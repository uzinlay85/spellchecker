<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>မြန်မာစာလုံးပေါင်းနှင့် စာပိုဒ် စစ်ဆေးရန်</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Padauk:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Padauk', sans-serif;
        }
        /* Custom scrollbar for better aesthetics */
        textarea::-webkit-scrollbar {
            width: 8px;
        }
        textarea::-webkit-scrollbar-track {
            background: #f0f4f8; /* Lighter track */
            border-radius: 10px;
        }
        textarea::-webkit-scrollbar-thumb {
            background: #a0aec0; /* Softer thumb color */
            border-radius: 10px;
        }
        textarea::-webkit-scrollbar-thumb:hover {
            background: #718096;
        }
        /* Loading spinner animation */
        .loader {
            border: 4px solid #e2e8f0; /* Lighter spinner track */
            border-top: 4px solid #4299e1; /* Blue spinner color */
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* Style for the details/summary dropdown */
        details > summary {
            list-style: none;
        }
        details > summary::-webkit-details-marker {
            display: none;
        }
        details[open] summary .plus-icon {
            transform: rotate(45deg);
        }
        .plus-icon {
            transition: transform 0.3s ease-in-out;
            font-weight: bold;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen flex items-center justify-center p-4">
    <div class="w-full max-w-6xl mx-auto bg-white/90 backdrop-blur-sm rounded-2xl shadow-2xl p-6 md:p-8 border border-gray-200">
        
        <!-- Header Section -->
        <div class="text-center mb-6">
            <h1 class="text-3xl md:text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-indigo-600">မြန်မာအရေးအသား တည်းဖြတ်ပေးသူ</h1>
            <p class="text-gray-600 mt-3 max-w-2xl mx-auto">ဤအက်ပ်သည် သင်ထည့်သွင်းလိုက်သော မြန်မာစာသားများ၏ စာလုံးပေါင်း၊ သဒ္ဒါ နှင့် စာပိုဒ်ဖွဲ့စည်းပုံတို့ကို Gemini AI ဖြင့် အလိုအလျောက်စစ်ဆေးတည်းဖြတ်ပေးသည်။</p>
        </div>

        <!-- API Key Input -->
        <div class="mb-4">
            <label for="apiKey" class="block text-sm font-medium text-gray-700 mb-2">သင့် Gemini API Key ကိုထည့်ပါ</label>
            <div class="relative">
                <input type="password" id="apiKey" class="w-full pl-4 pr-10 py-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200" placeholder="API Key ကို ဤနေရာတွင် ထည့်သွင်းပါ">
                <svg class="w-6 h-6 absolute top-1/2 right-3 -translate-y-1/2 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25Z" />
                </svg>
            </div>
        </div>

        <!-- Instructions for API Key -->
        <div class="mb-6 text-sm text-gray-600">
            <details class="bg-gray-50/80 p-3 rounded-lg cursor-pointer transition-all duration-300 hover:bg-gray-100">
                <summary class="font-medium text-gray-800 flex justify-between items-center">
                    <span>Gemini API Key ရယူနည်း လမ်းညွှန်</span>
                    <span class="plus-icon text-2xl text-blue-500">+</span>
                </summary>
                <div class="mt-3 pt-3 pl-4 border-l-2 border-blue-300 text-gray-700">
                    <p class="mb-2">1. <a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline font-semibold">Google AI Studio သို့ သွားပါ</a>။</p>
                    <p class="mb-2">2. သင်၏ Google Account ဖြင့် Login ဝင်ပါ။</p>
                    <p>3. "Create API key" ခလုတ်ကိုနှိပ်ပြီး API Key အသစ်တစ်ခု ပြုလုပ်ပါ။ ထို့နောက် ရရှိလာသော Key ကို ကူးယူပြီး အပေါ်ရှိအကွက်တွင် ထည့်သွင်းအသုံးပြုနိုင်ပါသည်။</p>
                </div>
            </details>
        </div>

        <!-- Main Content: Input and Output -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Input Area -->
            <div>
                <label for="inputText" class="block text-sm font-medium text-gray-700 mb-2">စစ်ဆေးလိုသော စာသားကို ထည့်ပါ</label>
                <textarea id="inputText" rows="12" class="w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 shadow-sm" placeholder="ဤနေရာတွင် စာရိုက်ထည့်ပါ..."></textarea>
            </div>
            <!-- Output Area -->
            <div>
                <label for="outputText" class="block text-sm font-medium text-gray-700 mb-2">ပြင်ဆင်ပြီးသော ရလဒ်</label>
                <div class="relative w-full h-full">
                    <textarea id="outputText" rows="12" readonly class="w-full p-4 text-base bg-gray-50 border border-gray-300 rounded-lg resize-none shadow-sm"></textarea>
                    <div id="loader" class="absolute inset-0 bg-white/80 backdrop-blur-sm flex items-center justify-center rounded-lg hidden">
                        <div class="loader"></div>
                        <p class="ml-4 text-gray-600 font-medium">စစ်ဆေးနေပါသည်...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="mt-6 flex flex-col sm:flex-row items-center justify-center gap-4">
            <button id="copyButton" class="w-full sm:w-auto bg-gradient-to-r from-teal-500 to-cyan-600 hover:from-teal-600 hover:to-cyan-700 text-white font-bold py-3 px-8 rounded-lg shadow-lg transition-all duration-300 transform hover:scale-105 hover:shadow-xl focus:outline-none focus:ring-4 focus:ring-cyan-300 flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                  <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                  <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                </svg>
                <span>ရလဒ်ကို ကော်ပီကူးရန်</span>
            </button>
        </div>

        <!-- Message Box -->
        <div id="messageBox" class="fixed top-5 right-5 bg-red-600 text-white py-2 px-4 rounded-lg shadow-lg transition-all duration-300 opacity-0 -translate-y-10 z-50">
            <p id="messageText"></p>
        </div>

    </div>

    <script>
        // Get DOM elements
        const apiKeyInput = document.getElementById('apiKey');
        const inputText = document.getElementById('inputText');
        const outputText = document.getElementById('outputText');
        const copyButton = document.getElementById('copyButton');
        const loader = document.getElementById('loader');
        const messageBox = document.getElementById('messageBox');
        const messageText = document.getElementById('messageText');

        // Debounce timer variable
        let debounceTimer;

        // Function to show messages
        function showMessage(message, isError = true) {
            messageText.textContent = message;
            messageBox.className = `fixed top-5 right-5 text-white py-3 px-5 rounded-lg shadow-xl transition-all duration-300 opacity-100 translate-y-0 z-50 ${isError ? 'bg-gradient-to-r from-red-500 to-red-600' : 'bg-gradient-to-r from-green-500 to-green-600'}`;
            setTimeout(() => {
                messageBox.classList.remove('opacity-100', 'translate-y-0');
            }, 3000);
        }

        // The main spell-checking function
        async function triggerSpellCheck() {
            const apiKey = apiKeyInput.value.trim();
            const text = inputText.value.trim();

            if (!text) {
                outputText.value = ''; // Clear output if input is empty
                return;
            }

            if (!apiKey) {
                showMessage('ကျေးဇူးပြု၍ သင်၏ API Key ကိုထည့်ပါ။');
                return;
            }

            loader.classList.remove('hidden');

            const prompt = `Please act as an expert Burmese language editor. Your task is to check and correct the spelling, grammar, and paragraph structure of the following Burmese text.

1.  **Spelling Correction:** For every word that you find to be misspelled, provide the correct spelling immediately after it, enclosed in parentheses (). For example, 'အိမ်မောင်' should become 'အိမ်မောင် (အိမ်ပေါ်)'. If a word is correct, leave it as is.
2.  **Paragraph Structuring:** Analyze the text for logical flow and readability. Insert appropriate paragraph breaks (new lines) where necessary to improve the structure and make the text easier to read.
3.  **Final Output:** Provide only the fully corrected and re-formatted text. Do not add any introductory or concluding sentences, just the final text.

Here is the text to check:
"${text}"`;

            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
            const payload = {
                contents: [{ parts: [{ text: prompt }] }]
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error?.message || `HTTP error! status: ${response.status}`);
                }

                const result = await response.json();
                
                if (result.candidates && result.candidates.length > 0 && result.candidates[0].content?.parts?.length > 0) {
                    const correctedText = result.candidates[0].content.parts[0].text;
                    if(inputText.value.trim() === text) {
                       outputText.value = correctedText.trim();
                    }
                } else {
                    throw new Error('API မှ မမျှော်လင့်သော တုံ့ပြန်မှု ရရှိပါသည်။');
                }

            } catch (error) {
                console.error('Error:', error);
                showMessage(`အမှားအယွင်းတစ်ခု ဖြစ်ပွားခဲ့သည်: ${error.message}`);
            } finally {
                loader.classList.add('hidden');
            }
        }

        // Debounce function call
        function debounceCheck() {
            clearTimeout(debounceTimer);
            debounceTimer = setTimeout(triggerSpellCheck, 1200); // 1.2-second delay
        }

        // Event listener for the input text area to trigger check on typing stop
        inputText.addEventListener('input', debounceCheck);
        
        // Also trigger a check if the API key is changed and there's text
        apiKeyInput.addEventListener('input', () => {
            if (inputText.value.trim()) {
                debounceCheck();
            }
        });

        // Event listener for the copy button
        copyButton.addEventListener('click', () => {
            const textToCopy = outputText.value;
            if (!textToCopy) {
                showMessage('ကော်ပီကူးရန် စာသားမရှိပါ။');
                return;
            }
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = textToCopy;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            try {
                document.execCommand('copy');
                showMessage('ကော်ပီကူးပြီးပါပြီ။', false);
            } catch (err) {
                showMessage('ကော်ပီကူးယူရာတွင် အမှားအယွင်းဖြစ်ပွားပါသည်။');
                console.error('Copy failed', err);
            }
            document.body.removeChild(tempTextArea);
        });
    </script>
</body>
</html>
